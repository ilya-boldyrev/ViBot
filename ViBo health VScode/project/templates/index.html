<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ViBo Health Project</title>
    <style>
        header {
            text-align: center;
        }
    </style>
    <style>
        body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
  background-color: #b3ae9d;
}

.chat-container {
  max-width: 600px;
  margin: auto;
  padding: 20px;
}

.chat-log {
  margin: 5px;
  border: 10px solid #cccccccc;
  padding: 10px;
  min-height: 300px;
  max-height: 400px;
  overflow-y: scroll;
  background-color: #ffffff;
}

.input-container {
  display: flex;
  margin-top: 3px;
  padding: 4px;
}

#userInput {
  flex-grow: 1;
  padding: 5px;
}

#sendMessage {
  background-color: #007bff;
  color: white;
  border: none;
  padding: 5px 10px;
  cursor: pointer;
}
    </style>
</head>
<body>

    <form method="post" action="/login" class="box">
        <button>
            log-in/sing-up
        </button>
    </form>
<header>
    <div class="image">
        <img alt="{{ url_for('static', filename='Logo_Vibo_RGB_transparent_web.png') }}"
             src="../static/Logo_Vibo_RGB_transparent_web.png" style="width: 200px; margin-top: 10px;">
    </div>
    <h1>Health Bot</h1> <!-- Add the "health bot" text here -->
</header>
<div class="chat-container">
    <div class="chat-log" id="chatLog">
        <!-- Chat messages will be displayed here -->
    </div>
    <div class="input-container">
        <label for="userInput"></label><input type="text" id="userInput" placeholder="Type your message...">
        <button id="sendMessage">Send</button>
    </div>
</div>
<script>
    // script.js
document.addEventListener("DOMContentLoaded", function () {
  const chatLog = document.getElementById("chatLog");
  const userInput = document.getElementById("userInput");
  const sendMessageBtn = document.getElementById("sendMessage");

  sendMessageBtn.addEventListener("click", () => {
    const userMessage = userInput.value.trim();  // Trim whitespace
    if (!userMessage) {
      alert("Message cannot be empty");
      return;
    }

    addMessageToChatLog(userMessage, "user");

    // Disable send button to prevent multiple submissions
    sendMessageBtn.disabled = true;

    // Make an AJAX request to the Flask server
    fetch("/get_ai_response", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ message: userMessage }),
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error(`Network response was not ok ${response.statusText}`);
        }
        return response.json();
      })
      .then((data) => {
        if (data.botResponse) {
          addMessageToChatLog(data.botResponse, "bot");
        } else {
          console.error("Unexpected response format:", data);
        }
      })
      .catch((error) => {
        console.error("Error fetching AI response:", error);
        addMessageToChatLog("Error fetching AI response. Please try again later.", "error");
      })
      .finally(() => {
        // Re-enable send button
        sendMessageBtn.disabled = false;
        userInput.value = "";
      });
  });

  function addMessageToChatLog(message, sender) {
    const messageDiv = document.createElement("div");
    messageDiv.className = `message ${sender}`;
    messageDiv.textContent = message;
    chatLog.appendChild(messageDiv);
  }
});


</script>
</body>
</html>
